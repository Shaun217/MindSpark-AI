<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MindSpark AI</title>
    <style>
        /* Dark Theme Styles imitating Tailwind */
        body { margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background-color: #0f172a; color: white; width: 360px; height: 500px; display: flex; flex-direction: column; }
        
        /* Utility Classes */
        .hidden { display: none !important; }
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .gap-2 { gap: 0.5rem; }
        .p-4 { padding: 1rem; }
        .p-2 { padding: 0.5rem; }
        
        /* Header */
        header { background-color: #1e293b; padding: 1rem; border-bottom: 1px solid #334155; display: flex; justify-content: space-between; align-items: center; }
        h1 { margin: 0; font-size: 1.1rem; font-weight: 600; color: #818cf8; }
        .settings-btn { background: none; border: none; color: #94a3b8; cursor: pointer; font-size: 1.2rem; }
        .settings-btn:hover { color: #fff; }

        /* Main Chat Area */
        #chat-container { flex: 1; overflow-y: auto; padding: 1rem; display: flex; flex-direction: column; gap: 0.75rem; }
        .msg { max-width: 85%; padding: 0.75rem; border-radius: 0.75rem; font-size: 0.9rem; line-height: 1.4; word-wrap: break-word; }
        .msg.user { align-self: flex-end; background-color: #4f46e5; color: white; border-bottom-right-radius: 0; }
        .msg.model { align-self: flex-start; background-color: #1e293b; color: #e2e8f0; border: 1px solid #334155; border-top-left-radius: 0; }
        .loading { color: #94a3b8; font-size: 0.8rem; text-align: center; }

        /* Footer */
        footer { padding: 1rem; background-color: #1e293b; border-top: 1px solid #334155; display: flex; gap: 0.5rem; }
        input[type="text"] { flex: 1; background-color: #0f172a; border: 1px solid #334155; color: white; padding: 0.75rem; border-radius: 0.5rem; outline: none; }
        input[type="text"]:focus { border-color: #6366f1; }
        button.send-btn { background-color: #4f46e5; border: none; color: white; padding: 0 1rem; border-radius: 0.5rem; cursor: pointer; font-weight: bold; }
        button.send-btn:hover { background-color: #4338ca; }
        button:disabled { opacity: 0.5; cursor: not-allowed; }

        /* Settings View */
        #settings-view { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: #0f172a; z-index: 10; padding: 1.5rem; box-sizing: border-box; }
        label { display: block; margin-bottom: 0.5rem; color: #94a3b8; font-size: 0.9rem; }
        .save-btn { width: 100%; padding: 0.75rem; background-color: #4f46e5; color: white; border: none; border-radius: 0.5rem; font-weight: bold; cursor: pointer; margin-top: 1rem; }

        /* Quick Actions */
        .actions-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; margin-bottom: 1rem; }
        .action-btn { background-color: #1e293b; border: 1px solid #334155; color: #cbd5e1; padding: 0.5rem; border-radius: 0.5rem; cursor: pointer; font-size: 0.8rem; transition: all 0.2s; }
        .action-btn:hover { border-color: #6366f1; color: white; }
    </style>
</head>
<body>

    <!-- Settings View -->
    <div id="settings-view" class="hidden">
        <h2 style="margin-top:0; color: #818cf8;">Settings</h2>
        <p style="font-size: 0.8rem; color: #94a3b8; margin-bottom: 1rem;">Enter your Google Gemini API Key to enable AI features.</p>
        <div>
            <label>API Key</label>
            <input type="password" id="api-key-input" placeholder="AIzaSy..." style="width: 100%; box-sizing: border-box;">
        </div>
        <button id="save-settings-btn" class="save-btn">Save Key</button>
        <button id="cancel-settings-btn" style="width: 100%; background:none; border:none; color:#94a3b8; padding:10px; cursor:pointer;">Back</button>
    </div>

    <!-- Main App -->
    <header>
        <div class="flex items-center gap-2">
            <span>‚ú®</span>
            <h1>MindSpark AI</h1>
        </div>
        <button id="open-settings-btn" class="settings-btn">‚öôÔ∏è</button>
    </header>

    <div id="chat-container">
        <!-- Messages go here -->
        <div class="actions-grid">
            <button class="action-btn" data-action="summarize_page">üìù Summarize Page</button>
            <button class="action-btn" data-action="explain_page">ü§î Explain Page</button>
            <button class="action-btn" data-action="fix_grammar">‚úçÔ∏è Fix Grammar</button>
            <button class="action-btn" data-action="translate">üåê Translate</button>
        </div>
        <div class="msg model">Hello! I'm MindSpark. How can I help you today?</div>
    </div>

    <footer>
        <input type="text" id="user-input" placeholder="Ask anything...">
        <button id="send-btn" class="send-btn">Send</button>
    </footer>

    <script src="popup.js"></script>
</body>
</html>